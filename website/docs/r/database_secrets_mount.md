---
layout: "vault"
page_title: "Vault: vault_database_secrets_mount resource"
sidebar_current: "docs-vault-resource-database-secrets-mount"
description: |-
  Configures any number of database secrets engines under a single mount resource
---

# vault\_database\_secrets\_mount

Configure any number of database secrets engines under a single dedicated mount resource.

~> **Important** All data provided in the resource configuration will be
written in cleartext to state and plan files generated by Terraform, and
will appear in the console output when Terraform runs. Protect these
artifacts accordingly. See
[the main provider documentation](../index.html)
for more details.

## Caveats:
This resource will be replaced for any of the following conditions:

- A database engine block is removed
- The `name` for any configured database engine is changed

## Example Usage

```hcl
resource "vault_database_secrets_mount" "db" {
  path = "db"

  mssql {
    name           = "db1"
    username       = "sa"
    password       = "super_secret_1"
    connection_url = "sqlserver://{{username}}:{{password}}@127.0.0.1:1433"
    allowed_roles = [
      "dev1",
    ]
    plugin_version = "v0.20.0"
    skip_static_role_import_rotation = true
    password_policy = "default"
    rotation_schedule = "0 * * * SAT"
    rotation_window   = 3600
  }

  postgresql {
    name              = "db2"
    username          = "postgres"
    password          = "super_secret_2"
    connection_url    = "postgresql://{{username}}:{{password}}@127.0.0.1:5432/postgres"
    verify_connection = true
    allowed_roles = [
      "dev2",
    ]
    plugin_version = "v0.19.0"
    skip_static_role_import_rotation = true
    password_policy = "default"
    rotation_schedule = "0 * * * SAT"
    rotation_window   = 3600
  }
}

resource "vault_database_secret_backend_role" "dev1" {
  name    = "dev1"
  backend = vault_database_secrets_mount.db.path
  db_name = vault_database_secrets_mount.db.mssql[0].name
  creation_statements = [
    "CREATE LOGIN [{{name}}] WITH PASSWORD = '{{password}}';",
    "CREATE USER [{{name}}] FOR LOGIN [{{name}}];",
    "GRANT SELECT ON SCHEMA::dbo TO [{{name}}];",
  ]
}

resource "vault_database_secret_backend_role" "dev2" {
  name    = "dev2"
  backend = vault_database_secrets_mount.db.path
  db_name = vault_database_secrets_mount.db.postgresql[0].name
  creation_statements = [
    "CREATE ROLE \"{{name}}\" WITH LOGIN PASSWORD '{{password}}' VALID UNTIL '{{expiration}}';",
    "GRANT SELECT ON ALL TABLES IN SCHEMA public TO \"{{name}}\";",
  ]
}
```

## Argument Reference

The following arguments are supported for the Vault `mount`:

* `path` - (Required) Where the secret backend will be mounted

* `description` - (Optional) Human-friendly description of the mount

* `default_lease_ttl_seconds` - (Optional) Default lease duration for tokens and secrets in seconds

* `max_lease_ttl_seconds` - (Optional) Maximum possible lease duration for tokens and secrets in seconds

* `audit_non_hmac_response_keys` - (Optional) Specifies the list of keys that will not be HMAC'd by audit devices in the response data object.

* `audit_non_hmac_request_keys` - (Optional) Specifies the list of keys that will not be HMAC'd by audit devices in the request data object.

* `local` - (Optional) Boolean flag that can be explicitly set to true to enforce local mount in HA environment

* `options` - (Optional) Specifies mount type specific options that are passed to the backend

* `seal_wrap` - (Optional) Boolean flag that can be explicitly set to true to enable seal wrapping for the mount, causing values stored by the mount to be wrapped by the seal's encryption capability

* `external_entropy_access` - (Optional) Boolean flag that can be explicitly set to true to enable the secrets engine to access Vault's external entropy source

* `allowed_managed_keys` - (Optional) Set of managed key registry entry names that the mount in question is allowed to access

The following arguments are common to all database engines:

* `plugin_name` - (Optional) Specifies the name of the plugin to use.

* `plugin_version` - (Optional) Specifies the semantic version of the plugin to use for this connection.

* `password_policy` - (Optional)  The name of the password policy to use when generating passwords for this database. If not specified, this will use a default policy defined as: 20 characters with at least 1 uppercase, 1 lowercase, 1 number, and 1 dash character.

* `skip_static_role_import_rotation` - (Optional) Specifies if a given static account's password should be rotated on creation of the static roles associated with this database config. This can be overridden at the role-level by the static role's skip_import_rotation field. The default is false. Requires Vault Enterprise 1.19+.

* `verify_connection` - (Optional) Whether the connection should be verified on
  initial configuration or not.

* `allowed_roles` - (Optional) A list of roles that are allowed to use this
  connection.

* `root_rotation_statements` - (Optional) A list of database statements to be executed to rotate the root user's credentials.

* `data` - (Optional) A map of sensitive data to pass to the endpoint. Useful for templated connection strings.

* `rotation_period` - (Optional) The amount of time in seconds Vault should wait before rotating the root credential.
  A zero value tells Vault not to rotate the root credential. The minimum rotation period is 10 seconds. Requires Vault Enterprise 1.19+.

* `rotation_schedule` - (Optional) The schedule, in [cron-style time format](https://en.wikipedia.org/wiki/Cron),
  defining the schedule on which Vault should rotate the root token. Requires Vault Enterprise 1.19+.

* `rotation_window` - (Optional) The maximum amount of time in seconds allowed to complete
  a rotation when a scheduled token rotation occurs. The default rotation window is
  unbound and the minimum allowable window is `3600`. Requires Vault Enterprise 1.19+.

* `disable_automated_rotation` - (Optional) Cancels all upcoming rotations of the root credential until unset. Requires Vault Enterprise 1.19+.

Supported list of database secrets engines that can be configured:

* `cassandra` - (Optional) A nested block containing configuration options for Cassandra connections.  
  *See [Configuration Options](#cassandra-configuration-options) for more info*

* `couchbase` - (Optional) A nested block containing configuration options for Couchbase connections.  
  *See [Configuration Options](#couchbase-configuration-options) for more info*
 
* `elasticsearch` - (Optional) A nested block containing configuration options for Elasticsearch connections.  
  *See [Configuration Options](#elasticsearch-configuration-options) for more info*

* `hana` - (Optional) A nested block containing configuration options for SAP HanaDB connections.  
  *See [Configuration Options](#sap-hanadb-sap-configuration-options) for more info*
 
* `mongodb` - (Optional) A nested block containing configuration options for MongoDB connections.  
  *See [Configuration Options](#mongodb-configuration-options) for more info*

* `mongodbatlas` - (Optional) A nested block containing configuration options for MongoDB Atlas connections.  
  *See [Configuration Options](#mongodb-atlas-configuration-options) for more info*

* `mssql` - (Optional) A nested block containing configuration options for MSSQL connections.  
  *See [Configuration Options](#mssql-configuration-options) for more info*

* `mysql` - (Optional) A nested block containing configuration options for MySQL connections.  
  *See [Configuration Options](#mysql-configuration-options) for more info*

* `mysql_rds` - (Optional) A nested block containing configuration options for RDS MySQL connections.  
  *See [Configuration Options](#mysql-configuration-options) for more info*

* `mysql_aurora` - (Optional) A nested block containing configuration options for Aurora MySQL connections.  
  *See [Configuration Options](#mysql-configuration-options) for more info*

* `mysql_legacy` - (Optional) A nested block containing configuration options for legacy MySQL connections.  
  *See [Configuration Options](#mysql-configuration-options) for more info*

* `oracle` - (Optional) A nested block containing configuration options for Oracle connections.  
  *See [Configuration Options](#oracle-configuration-options) for more info*

* `postgresql` - (Optional) A nested block containing configuration options for PostgreSQL connections.  
  *See [Configuration Options](#postgresql-configuration-options) for more info*

* `redshift` - (Optional) A nested block containing configuration options for AWS Redshift connections.  
  *See [Configuration Options](#aws-redshift-configuration-options) for more info*

* `snowflake` - (Optional) A nested block containing configuration options for Snowflake connections.  
  *See [Configuration Options](#snowflake-configuration-options) for more info*

* `influxdb` - (Optional) A nested block containing configuration options for InfluxDB connections.  
  *See [Configuration Options](#influxdb-configuration-options) for more info*

* `redis` - (Optional) A nested block containing configuration options for Redis connections.  
  *See [Configuration Options](#redis-configuration-options) for more info*

* `redis_elasticache` - (Optional) A nested block containing configuration options for Redis ElastiCache connections.  
  *See [Configuration Options](#redis-elasticache-configuration-options) for more info*
 
### Cassandra Configuration Options

* `hosts` - (Required) The hosts to connect to.

* `username` - (Required) The username to authenticate with.

* `password` - (Required) The password to authenticate with.

* `port` - (Optional) The default port to connect to if no port is specified as
  part of the host.

* `tls` - (Optional) Whether to use TLS when connecting to Cassandra.

* `insecure_tls` - (Optional) Whether to skip verification of the server
  certificate when using TLS.

* `pem_bundle` - (Optional) Concatenated PEM blocks configuring the certificate
  chain.

* `pem_json` - (Optional) A JSON structure configuring the certificate chain.

* `protocol_version` - (Optional) The CQL protocol version to use.

* `connect_timeout` - (Optional) The number of seconds to use as a connection
  timeout.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

* `username_template` - (Optional)  Template describing how dynamic usernames are generated.

* `tls_server_name` - (Optional) Specifies the name to use as the SNI host when connecting to the Cassandra server via TLS.

* `local_datacenter` - (Optional) If set, enables host selection policy which will prioritize and use hosts which are in the local datacenter before hosts in all other datacenters.

* `socket_keep_alive` - (Optional) The keep-alive period for an active network connection. If zero, keep-alives are not enabled.

* `consistency` - (Optional)  Specifies the consistency option to use. See the gocql definition for valid options.

### Couchbase Configuration Options

* `hosts` - (Required) A set of Couchbase URIs to connect to. Must use `couchbases://` scheme if `tls` is `true`.

* `username` - (Required) Specifies the username for Vault to use.

* `password` - (Required) Specifies the password corresponding to the given username.

* `tls` - (Optional) Whether to use TLS when connecting to Couchbase.

* `insecure_tls` - (Optional) Whether to skip verification of the server
  certificate when using TLS.

* `base64_pem` - (Optional) Required if `tls` is `true`. Specifies the certificate authority of the Couchbase server, as a PEM certificate that has been base64 encoded.

* `bucket_name` - (Optional) Required for Couchbase versions prior to 6.5.0. This is only used to verify vault's connection to the server.

* `username_template` - (Optional) Template describing how dynamic usernames are generated.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).
 
### Elasticsearch Configuration Options

* `url` - (Required) The URL for Elasticsearch's API. https requires certificate
  by trusted CA if used.

* `username` - (Required) The username to be used in the connection.

* `password` - (Required) The password to be used in the connection.
 
* `ca_cert` - (Optional) The path to a PEM-encoded CA cert file to use to verify the Elasticsearch server's identity.

* `ca_path` - (Optional) The path to a directory of PEM-encoded CA cert files to use to verify the Elasticsearch server's identity.

* `client_cert` - (Optional) The path to the certificate for the Elasticsearch client to present for communication.

* `client_key` - (Optional) The path to the key for the Elasticsearch client to use for communication.

* `tls_server_name` - (Optional) This, if set, is used to set the SNI host when connecting via TLS.

* `insecure` - (Optional) Whether to disable certificate verification.

* `username_template` - (Optional) For Vault v1.7+. The template to use for username generation.  
  See [Vault docs](https://www.vaultproject.io/docs/concepts/username-templating) for more details.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### InfluxDB Configuration Options

* `host` - (Required) The host to connect to.

* `username` - (Required) The username to authenticate with.

* `password` - (Required) The password to authenticate with.

* `port` - (Optional) The default port to connect to if no port is specified as
  part of the host.

* `tls` - (Optional) Whether to use TLS when connecting to Cassandra.

* `insecure_tls` - (Optional) Whether to skip verification of the server
  certificate when using TLS.

* `pem_bundle` - (Optional) Concatenated PEM blocks configuring the certificate
  chain.

* `pem_json` - (Optional) A JSON structure configuring the certificate chain.

* `username_template` - (Optional) Template describing how dynamic usernames are generated.

* `connect_timeout` - (Optional) The number of seconds to use as a connection
  timeout.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### MongoDB Configuration Options

* `connection_url` - (Required) A URL containing connection information.  
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/mongodb.html#sample-payload)

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `username_template` - (Optional) For Vault v1.7+. The template to use for username generation.  
  See [Vault docs](https://www.vaultproject.io/docs/concepts/username-templating)

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### MongoDB Atlas Configuration Options

* `public_key` - (Required) The Public Programmatic API Key used to authenticate with the MongoDB Atlas API.

* `private_key` - (Required) The Private Programmatic API Key used to connect with MongoDB Atlas API.

* `project_id` - (Required) The Project ID the Database User should be created within.

* `username_template` - (Optional) Template describing how dynamic usernames are generated.

### SAP HanaDB Configuration Options

* `connection_url` - (Required) A URL containing connection information.
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/hanadb.html#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  use.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  maintain.

* `max_connection_lifetime` - (Optional) The maximum number of seconds to keep
  a connection alive for.

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `disable_escaping` - (Optional) Disable special character escaping in username and password.

* `username_template` - (Optional) Template describing how dynamic usernames are generated.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### MSSQL Configuration Options

* `connection_url` - (Required) A URL containing connection information.  
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/mssql.html#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  use.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  maintain.

* `max_connection_lifetime` - (Optional) The maximum number of seconds to keep
  a connection alive for.

* `username_template` - (Optional) For Vault v1.7+. The template to use for username generation.  
   See [Vault docs](https://www.vaultproject.io/docs/concepts/username-templating)

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `disable_escaping` - (Optional) Disable special character escaping in username and password.

* `contained_db` - (Optional bool: false) For Vault v1.9+. Set to true when the target is a
  Contained Database, e.g. AzureSQL.  
  See [Vault docs](https://www.vaultproject.io/api/secret/databases/mssql#contained_db)

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### MySQL Configuration Options

* `connection_url` - (Required) A URL containing connection information.  
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/mysql-maria.html#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  use.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  maintain.

* `max_connection_lifetime` - (Optional) The maximum number of seconds to keep
  a connection alive for.

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `tls_certificate_key` - (Optional) x509 certificate for connecting to the database. This must be a PEM encoded version of the private key and the certificate combined.

* `tls_ca` - (Optional) x509 CA file for validating the certificate presented by the MySQL server. Must be PEM encoded.

* `username_template` - (Optional) For Vault v1.7+. The template to use for username generation.  
   See [Vault docs](https://www.vaultproject.io/docs/concepts/username-templating)

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### Oracle Configuration Options

* `connection_url` - (Required) A URL containing connection information.  
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/oracle.html#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  use.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  maintain.

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `max_connection_lifetime` - (Optional) The maximum number of seconds to keep
  a connection alive for.

* `username_template` - (Optional) For Vault v1.7+. The template to use for username generation.  
  See [Vault docs](https://www.vaultproject.io/docs/concepts/username-templating)

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### PostgreSQL Configuration Options

* `connection_url` - (Required) A URL containing connection information.  
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/postgresql.html#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  use.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  maintain.

* `max_connection_lifetime` - (Optional) The maximum number of seconds to keep
  a connection alive for.

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `disable_escaping` - (Optional) Disable special character escaping in username and password.

* `username_template` - (Optional) For Vault v1.7+. The template to use for username generation.
  See [Vault docs](https://www.vaultproject.io/docs/concepts/username-templating)

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### Redis Configuration Options

* `host` - (Required) The host to connect to.

* `username` - (Required) The username to authenticate with.

* `password` - (Required) The password to authenticate with.

* `port` - (Optional) The default port to connect to if no port is specified as
  part of the host.

* `tls` - (Optional) Whether to use TLS when connecting to Redis.

* `insecure_tls` - (Optional) Whether to skip verification of the server
  certificate when using TLS.

* `ca_cert` - (Optional) The contents of a PEM-encoded CA cert file to use to verify the Redis server's identity.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### Redis ElastiCache Configuration Options

* `url` - (Required) The configuration endpoint for the ElastiCache cluster to connect to.

* `username` - (Optional) The AWS access key id to use to talk to ElastiCache. 
  If omitted the credentials chain provider is used instead.

* `password` - (Optional) The AWS secret key id to use to talk to ElastiCache. 
  If omitted the credentials chain provider is used instead.

* `region` - (Optional) The AWS region where the ElastiCache cluster is hosted.
  If omitted the plugin tries to infer the region from the environment.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### AWS Redshift Configuration Options

* `connection_url` - (Required) Specifies the Redshift DSN. 
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/redshift#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  the database.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  the database.

* `max_connection_lifetime` - (Optional) The maximum amount of time a connection may be reused.

* `username` - (Optional) The root credential username used in the connection URL.

* `password` - (Optional) The root credential password used in the connection URL.

* `disable_escaping` - (Optional) Disable special character escaping in username and password.

* `username_template` - (Optional) - [Template](https://www.vaultproject.io/docs/concepts/username-templating) describing how dynamic usernames are generated.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

### Snowflake Configuration Options

* `connection_url` - (Required) A URL containing connection information.  
  See [Vault docs](https://www.vaultproject.io/api-docs/secret/databases/snowflake#sample-payload)

* `max_open_connections` - (Optional) The maximum number of open connections to
  use.

* `max_idle_connections` - (Optional) The maximum number of idle connections to
  maintain.

* `max_connection_lifetime` - (Optional) The maximum number of seconds to keep
  a connection alive for.

* `username` - (Optional) The username to be used in the connection (the account admin level).

* `password` - (Optional) The password to be used in the connection.

* `username_template` - (Optional) - [Template](https://www.vaultproject.io/docs/concepts/username-templating) describing how dynamic usernames are generated.

* `password_wo_version` - (Optional)  The version of the `password_wo`. For more info see [updating write-only attributes](https://registry.terraform.io/providers/hashicorp/vault/latest/docs/guides/using_write_only_attributes.html#updating-write-only-attributes).

## Ephemeral Attributes Reference

The following write-only attributes are supported for all DBs that support username/password:

* `password_wo` - (Optional) The password for the user. Can be updated.
  **Note**: This property is write-only and will not be read from the API.

## Attributes Reference

* `engine_count` - The total number of database secrets engines configured.

## Import

Database secret backend connections can be imported using the `path` e.g.

```
$ terraform import vault_database_secrets_mount.db db
```
