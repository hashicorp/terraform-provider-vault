---
layout: "vault"
page_title: "Vault: vault_keymgmt_replicate_key resource"
description: |-
  Replicates keys across regions in AWS KMS (AWS KMS only)
---

# vault\_keymgmt\_replicate\_key

Manages key replication across multiple AWS regions in AWS KMS. This resource enables AWS KMS multi-region keys, allowing the same key material to be used across different AWS regions for high availability and disaster recovery.

**Note:** This resource is only applicable to AWS KMS and does not work with Azure Key Vault or GCP Cloud KMS.

When you replicate a key to AWS KMS, it becomes a multi-region key that can be used for encryption and decryption operations in multiple AWS regions while maintaining the same key material.

~> **Important**
All data provided in the resource configuration will be written in cleartext to
state and plan files generated by Terraform, and will appear in the console
output when Terraform runs. Protect these artifacts accordingly. See [the main provider documentation](../index.html) for more details.

For more information on AWS KMS multi-region keys with Vault, please refer to the Vault [documentation](https://developer.hashicorp.com/vault/docs/secrets/key-management).

**Note** this feature is available only with Vault Enterprise and requires a configured AWS KMS provider.

## Example Usage

```hcl
resource "vault_mount" "keymgmt" {
  path = "keymgmt"
  type = "keymgmt"
}

resource "vault_keymgmt_key" "key" {
  path = vault_mount.keymgmt.path
  name = "multi-region-key"
  type = "aes256-gcm96"
  
  replica_regions = ["us-east-1", "eu-west-1"]
}

resource "vault_keymgmt_aws_kms" "aws" {
  path           = vault_mount.keymgmt.path
  name           = "aws-kms"
  key_collection = "us-west-2"
  access_key     = var.aws_access_key_id
  secret_key     = var.aws_secret_access_key
}

resource "vault_keymgmt_distribute_key" "dist" {
  path     = vault_mount.keymgmt.path
  kms_name = vault_keymgmt_aws_kms.aws.name
  key_name = vault_keymgmt_key.key.name
  purpose  = ["encrypt", "decrypt"]
}

resource "vault_keymgmt_replicate_key" "replicate" {
  path     = vault_mount.keymgmt.path
  kms_name = vault_keymgmt_aws_kms.aws.name
  key_name = vault_keymgmt_key.key.name
  
  depends_on = [vault_keymgmt_distribute_key.dist]
}
```

## Argument Reference

The following arguments are supported:

* `namespace` - (Optional) The namespace of the target resource.
  The value should not contain leading or trailing forward slashes.
  The `namespace` is always relative to the provider's configured
  [namespace](/docs/providers/vault/index.html#namespace).
  *Available only for Vault Enterprise*.

* `path` - (Required) Path where the Key Management secrets engine is mounted.

* `kms_name` - (Required) Name of the AWS KMS provider (configured via `vault_keymgmt_aws_kms`).

* `key_name` - (Required) Name of the key to replicate (created via `vault_keymgmt_key`). The key must have `replica_regions` configured and must already be distributed to the AWS KMS provider.

## Attributes Reference

In addition to the arguments above, the following attributes are exported:

* `id` - The unique identifier for the key replication. Format: `{path}/kms/{kms_name}/key/{key_name}/replicate`

## Import

Key replication resources can be imported using the format `{path}/kms/{kms_name}/key/{key_name}/replicate`, e.g.

```
$ terraform import vault_keymgmt_replicate_key.us_east keymgmt/kms/aws-us-west-2/key/multi-region-key/replicate
```

**Note**: The key must have `replica_regions` configured in `vault_keymgmt_key` and must be distributed to the AWS KMS provider using `vault_keymgmt_distribute_key` before replication.
