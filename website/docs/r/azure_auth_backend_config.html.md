---
layout: "vault"
page_title: "Vault: vault_azure_auth_backend_config resource"
sidebar_current: "docs-vault-resource-azure-auth-backend-config"
description: |-
  Configures the Azure Auth Backend in Vault.
---

# vault\_azure\_auth\_backend\_config

Configures the Azure Auth Backend in Vault.

This resource sets the access key and secret key that Vault will use
when making API requests on behalf of an Azure Auth Backend. It can also
be used to override the URLs Vault uses when making those API requests.

For more information, see the
[Vault docs](https://www.vaultproject.io/api-docs/auth/azure#configure).

~> **Important** All data provided in the resource configuration will be
written in cleartext to state and plan files generated by Terraform, and
will appear in the console output when Terraform runs. Protect these
artifacts accordingly. See
[the main provider documentation](../index.html)
for more details.

## Example Usage

You can setup the Azure auth engine with Workload Identity Federation (WIF) for a secret-less configuration:
```hcl
resource "vault_auth_backend" "example" {
  type = "azure"
  identity_token_key = "example-key"
}

resource "vault_azure_auth_backend_config" "example" {
  backend                 = vault_auth_backend.example.path
  tenant_id               = "11111111-2222-3333-4444-555555555555"
  client_id               = "11111111-2222-3333-4444-555555555555"
  identity_token_audience = "<TOKEN_AUDIENCE>"
  identity_token_ttl      = "<TOKEN_TTL>"
  rotation_schedule       = "0 * * * SAT"
  rotation_window         = 3600
}
```

```hcl
resource "vault_auth_backend" "example" {
  type = "azure"
}

resource "vault_azure_auth_backend_config" "example" {
  backend           = vault_auth_backend.example.path
  tenant_id         = "11111111-2222-3333-4444-555555555555"
  client_id         = "11111111-2222-3333-4444-555555555555"
  client_secret     = "01234567890123456789"
  resource          = "https://vault.hashicorp.com"
  rotation_schedule = "0 * * * SAT"
  rotation_window   = 3600
}
```

You can use the write-only fields to prevent the client secret from being stored in Terraform state:

```hcl
resource "vault_auth_backend" "example" {
  type = "azure"
}

resource "vault_azure_auth_backend_config" "example" {
  backend                  = vault_auth_backend.example.path
  tenant_id                = "11111111-2222-3333-4444-555555555555"
  client_id                = "11111111-2222-3333-4444-555555555555"
  client_secret_wo         = var.azure_client_secret  # Never stored in state
  client_secret_wo_version = 1                         # Increment to rotate
  resource                 = "https://vault.hashicorp.com"
}
```

## Argument Reference

The following arguments are supported:

* `namespace` - (Optional) The namespace to provision the resource in.
  The value should not contain leading or trailing forward slashes.
  The `namespace` is always relative to the provider's configured [namespace](/docs/providers/vault/index.html#namespace).
   *Available only for Vault Enterprise*.

* `tenant_id` - (Required) The tenant id for the Azure Active Directory
	organization.

* `resource` - (Required) The configured URL for the application registered in
	Azure Active Directory.

* `backend` - (Optional) The path the Azure auth backend being configured was
	mounted at.  Defaults to `azure`.

* `client_id` - (Optional) The client id for credentials to query the Azure APIs.
	Currently read permissions to query compute resources are required.

* `client_secret` - (Optional) The client secret for credentials to query the
	Azure APIs. Mutually exclusive with `client_secret_wo`. **Note:** This field will be
	stored in Terraform state. Consider using `client_secret_wo` instead for enhanced security.

* `client_secret_wo_version` - (Optional) Version counter for the write-only client secret.
	Increment this value to trigger an update of the client secret in Vault.
	Required when using `client_secret_wo`.

* `environment` - (Optional) The Azure cloud environment. Valid values:
	AzurePublicCloud, AzureUSGovernmentCloud, AzureChinaCloud,
	AzureGermanCloud.  Defaults to `AzurePublicCloud`.

* `max_retries` - (Optional) Maximum number of retries for Azure API requests. 
	Defaults to `3`.

* `retry_delay` - (Optional) The initial delay in seconds between retries for Azure API requests.
	Defaults to `4`.

* `max_retry_delay` - (Optional) The maximum delay in seconds between retries for Azure API requests.
	Defaults to `60`.

* `identity_token_audience` - (Optional) The audience claim value for plugin identity tokens. Requires Vault 1.17+.
    *Available only for Vault Enterprise*

* `identity_token_ttl` - (Optional) The TTL of generated identity tokens in seconds.
    Defaults to 1 hour. Uses [duration format strings](https://developer.hashicorp.com/vault/docs/concepts/duration-format).
    Requires Vault 1.17+. *Available only for Vault Enterprise*

* `rotation_period` - (Optional) The amount of time in seconds Vault should wait before rotating the root credential.
  A zero value tells Vault not to rotate the root credential. The minimum rotation period is 10 seconds. Requires Vault Enterprise 1.19+.
  *Available only for Vault Enterprise*

* `rotation_schedule` - (Optional) The schedule, in [cron-style time format](https://en.wikipedia.org/wiki/Cron),
  defining the schedule on which Vault should rotate the root token. Requires Vault Enterprise 1.19+.
  *Available only for Vault Enterprise*

* `rotation_window` - (Optional) The maximum amount of time in seconds allowed to complete
  a rotation when a scheduled token rotation occurs. The default rotation window is
  unbound and the minimum allowable window is `3600`. Requires Vault Enterprise 1.19+.
  *Available only for Vault Enterprise*

* `disable_automated_rotation` - (Optional) Cancels all upcoming rotations of the root credential until unset. Requires Vault Enterprise 1.19+.
  *Available only for Vault Enterprise*

## Ephemeral Attributes Reference

The following write-only attributes are supported:

* `client_secret_wo` - (Optional) The client secret for credentials to query the Azure APIs,
	provided as a write-only field. This value will **never** be stored in Terraform state.
	Mutually exclusive with `client_secret`. Must be used with `client_secret_wo_version`.
	To rotate the secret, update the value and increment `client_secret_wo_version`.

## Attributes Reference

No additional attributes are exported by this resource.

## Import

Azure auth backends can be imported using `auth/`, the `backend` path, and `/config` e.g.

```
$ terraform import vault_azure_auth_backend_config.example auth/azure/config
```
